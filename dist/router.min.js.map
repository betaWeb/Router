{
  "version": 3,
  "sources": ["../src/Route.ts", "../src/Router.ts"],
  "sourcesContent": ["export default class Route {\n\n    public path: string = null\n\n    public params?: string[] = []\n\n    public callback: Function = null\n\n    public name: string = null\n\n    private readonly regex_path: RegExp = null\n\n    constructor(path: string, callback: Function, name: string = null) {\n        this.path = path\n        this.params = path.match(/(:\\w+)/gi) || []\n        this.callback = callback\n        this.name = name\n        this.regex_path = new RegExp(\"^\" + path.replace(/:[^\\s/]+/g, '([\\\\w-]+)') + \"$\")\n    }\n\n    public match(path: string): RouteMatch|null {\n        const match = path.match(this.regex_path)\n\n        if (match === null) {\n            return null\n        }\n\n        match.shift()\n\n        return {\n            path: this.path,\n            callback: this.callback,\n            name: this.name,\n            params: match.reduce((acc, value, index) => {\n                if (this.params[index]) {\n                    const key = this.params[index].replace(':', '')\n\n                    acc[key] = value\n                }\n\n                return acc\n            }, {})\n        }\n    }\n\n}", "import Route from \"~Route\";\n\nexport default class Router {\n\n    public mode: string = 'history'\n\n    public root: string = '/'\n\n    private routes: RoutesCollection = []\n\n    private current: string = null\n\n    private interval: number = null\n\n    private previous: string[] = []\n\n    private prefixes: string[] = []\n\n    constructor(options: RouterOptions = {}) {\n        this.mode = window.history.pushState ? 'history' : 'hash'\n\n        if (options.mode) {\n            this.mode = options.mode\n        }\n\n        if (options.root) {\n            this.root = options.root\n        }\n\n        if (options.routes) {\n            this.defineRoutes(options.routes)\n        }\n\n        this.watchUrl = this.watchUrl.bind(this)\n\n        this.listen()\n    }\n\n    public add(path: string, cb: Function, name?: string): Router {\n        if (this.prefixes.length > 0) {\n            path = this.prefixes.join('/') + '/' + path\n        }\n\n        this.routes.push(\n            // @ts-ignore\n            new Route(Router.clearSlashes(path), cb, name)\n        )\n\n        return this\n    }\n\n    public remove(path: string): Router {\n        this.routes = this.routes.filter(route => route.path !== path)\n\n        return this\n    }\n\n    public back(): void {\n        if (this.mode === 'history') {\n            window.history.back()\n        }\n    }\n\n    public forward(): void {\n        if (this.mode === 'history') {\n            window.history.forward()\n        }\n    }\n\n    public flush(): Router {\n        this.routes = []\n\n        return this\n    }\n\n    public navigate(options: NavigationOptions|string = {}): Router {\n        let path: string\n\n        if (typeof options === 'string') {\n            path = options\n        } else {\n            if (options.name) {\n                const params = options.params || {};\n\n                const route = this.routes.find(route => route.name === options.name)\n\n                if (route) {\n                    path = route.path\n\n                    for (let key in params) {\n                        if (params.hasOwnProperty(key)) {\n                            path = path.replace(':' + key, params[key])\n                        }\n                    }\n                }\n            } else {\n                path = options.path\n            }\n        }\n\n        if (!path) {\n            return\n        }\n\n        if (this.mode === 'history') {\n            window.history.pushState(null, null, this.root + Router.clearSlashes(path))\n        } else {\n            const href = `${window.location.href.replace(/#(.*)$/, '')}#${path}`\n\n            this.previous.unshift(href)\n\n            window.location.href = href\n        }\n\n        return this\n    }\n\n    public group(prefix: string, callback: Function): Router {\n        this.prefixes.unshift(\n            Router.clearSlashes(prefix)\n        )\n\n        callback.apply(this)\n\n        this.prefixes.shift()\n\n        return this\n    }\n\n    private defineRoutes(routes: RouteOption[]): void {\n        for (let route of routes) {\n            if (route.group) {\n                this.group(route.group, () => {\n                    this.add(route.path, route.callback, route.name)\n                })\n            } else {\n                this.add(route.path, route.callback, route.name)\n            }\n        }\n    }\n\n    private getFragment(): string {\n        let fragment: string\n\n        if (this.mode === 'history') {\n            fragment = Router.clearSlashes(decodeURI(window.location.pathname + window.location.search))\n            fragment = fragment.replace(/\\?(.*)$/, '')\n            fragment = this.root !== '/' ? fragment.replace(this.root, '') : fragment\n        } else {\n            const match = window.location.href.match(/#(.*)$/)\n\n            fragment = match ? match[1] : ''\n        }\n        return Router.clearSlashes(fragment)\n    }\n\n    private listen(): void {\n        clearInterval(this.interval)\n\n        this.interval = setInterval(this.watchUrl, 50)\n    }\n\n    private watchUrl(): void {\n        if (this.current === this.getFragment()) {\n            return\n        }\n\n        this.current = this.getFragment()\n\n        for (let route of this.routes) {\n            let match = route.match(this.current)\n\n            if (match !== null) {\n                let params = [\n                    ...Object.values(match.params),\n                    this.current,\n                    route\n                ]\n\n                match.callback.apply(this, params)\n\n                break;\n            }\n        }\n    }\n\n    private static clearSlashes(path: string) {\n        return path.toString().replace(/(^\\/)|(\\/$)/ig, '')\n    }\n}\n\nif (window && document) {\n    window['Router'] = Router\n}\n"],
  "mappings": "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",
  "names": []
}
